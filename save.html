<!doctype html>
<meta charset="utf-8">
<script>
(function () {
  const p     = new URLSearchParams(location.search);
  const tk    = p.get('tk')    || '';
  const redir = p.get('redir') || '/';

  try {
    // Guardar en localStorage
    localStorage.setItem('tp_token_v1', tk);
    localStorage.setItem('tp_redirect', redir);
    localStorage.setItem('ls_token', tk);
    localStorage.setItem('ls_redir', redir);

    // Cookies con compatibilidad iOS PWA
    document.cookie = 'tp_token_v1=' + encodeURIComponent(tk) + '; path=/; max-age=31536000; SameSite=None; Secure';
    document.cookie = 'tp_redirect=' + encodeURIComponent(redir) + '; path=/; max-age=31536000; SameSite=None; Secure';
  } catch(e) {
    console.error('Error al guardar sesi√≥n:', e);
  }

  location.replace(redir);
})();
</script>
