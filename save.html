<!doctype html><meta charset="utf-8">
<script>
  // Helpers
  function setCookie(name, value, days){
    const maxAge = days ? days*24*60*60 : 0; // segundos
    // Importante: Secure + SameSite=Lax para PWA en HTTPS
    document.cookie = `${name}=${encodeURIComponent(value)}; Max-Age=${maxAge}; Path=/; SameSite=Lax; Secure`;
  }
  const q = new URLSearchParams(location.search);
  const tk    = q.get('tk')     || q.get('token')    || '';
  const redir = q.get('redir')  || q.get('redirect') || '/';

  try{ localStorage.setItem('tp_token_v1', tk); }catch(e){}
  try{ localStorage.setItem('tp_redirect',  redir); }catch(e){}

  // Guarda por 180 d√≠as
  if (tk)    setCookie('tp_token_v1', tk,    180);
  if (redir) setCookie('tp_redirect',  redir, 180);

  location.replace(redir);
</script>
