<!doctype html><meta charset="utf-8">
<script>
(function () {
  // Puerta (Apps Script)
  const DOOR = 'https://script.google.com/macros/s/AKfycbzQmsWA0CdVjdKzXHTSJeNhWFfvou-ffyL_cWQ73piWaakxZ8fv7Z9KPXdvDNae9xEY2A/exec';

  function ckGet(name){
    const v = ('; ' + document.cookie).split('; ' + name + '=');
    return v.length > 1 ? decodeURIComponent(v.pop().split(';').shift() || '') : '';
  }

  // Lee con prioridad tp_*, pero acepta ls_* y cookies
  const tk =  localStorage.getItem('tp_token_v1')
          || localStorage.getItem('ls_token')
          || ckGet('tp_token_v1')
          || '';

  const redir =  localStorage.getItem('tp_redirect')
               || localStorage.getItem('ls_redir')
               || ckGet('tp_redirect')
               || '';

  if (tk && redir && redir !== '/') {
    location.replace(redir);
  } else {
    try {
      ['tp_token_v1','tp_redirect','ls_token','ls_redir'].forEach(k => localStorage.removeItem(k));
    } catch(e) {}
    location.replace(DOOR);
  }
})();
</script>
